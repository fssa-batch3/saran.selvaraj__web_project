<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Account</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css"/>
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.min.css'></link>
    <link rel="stylesheet" href="../assets/styles/profile.css">
  </head>
  <body>
    <div class="customer-details">
      <form id = "profile-form" class="account">
        <div>
          <div class="first-name">First-name</div>
          <input type="text" id="Full-name" class="first-nam" disabled></input>

          <div class="first-name">User-name</div>
          <input type="text" id="User-name" class="first-nam" disabled></input>

          <div class="first-name">Email</div>
          <input type="email" id="Email" class="first-nam" disabled></input>

          <div class="first-name">Phonenumber</div>
          <input type="number" id="Phonenumber" class="first-nam" disabled></input>

          <div class="first-name">Address</div>
          <!-- <input type="textarea" id="Address" class="first-nam"></input> -->
          <textarea rows="4" cols="60" id="Address"  disabled>
            </textarea>
        </div>
        <button id = "edit" type="submit" onclick="edit" class="edit-save-delete">Edit</button>
        <button id = "save" class="edit-save-delete">Save</button>
        <button id = "deletes" onclick="Delete" class="edit-save-delete">Delete</button>
      </form>
    </div>
    
  </body>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@7.12.15/dist/sweetalert2.all.min.js"></script> 
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.21.0/firebase-app.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCzUfcRW9gJHvotcnn9Ux4FOCk6i0UPgU0",
      authDomain: "pet-mall-f0291.firebaseapp.com",
      projectId: "pet-mall-f0291",
      storageBucket: "pet-mall-f0291.appspot.com",
      messagingSenderId: "189746601669",
      appId: "1:189746601669:web:ee94c467dad09aa8c8daac"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
  </script>
  <script>

      // let profile = localStorage.getItem();
      // console.log(user_email);
      let Email =JSON.parse(window.localStorage.getItem("useremail"))
      console.log(Email);
      let details = JSON.parse(window.localStorage.getItem("User_data"))//if (userpers===seller){

      // details = JSON.parse(window.localStorage.getItem("Seller_data"))}Else if(userpers===admin){ details = JSON.parse(window.localStorage.getItem("admin_data"))}
     console.log(details)
     let user_profile = details.find(e => e["email"] == Email)
    console.log(user_profile);
      
      let save = document.getElementById("save");
      let edit = document.getElementById("edit");
      let deletes = document.getElementById("deletes")
      
      let full_name = document.getElementById("Full-name").value = user_profile["full_name"];
      let user_name = document.getElementById("User-name").value = user_profile["user_name"];
      let email = document.getElementById("Email").value = user_profile["email"];
      let phone = document.getElementById("Phonenumber").value = user_profile["phone"];
      let Address = document.getElementById("Address").value = user_profile["Address"];
      
    edit.addEventListener("click",function (event){
    event.preventDefault()
    let inputs = document.getElementById("Full-name");
    if (inputs.disabled) {
        document.getElementById("Full-name").disabled = false;
        document.getElementById("User-name").disabled = false;
        document.getElementById("Email").disabled = false;
        document.getElementById("Phonenumber").disabled = false;
        document.getElementById("Address").disabled = false;

    }
    

    save.addEventListener("click",function(event){
    event.preventDefault()
    let full_name = document.getElementById("Full-name").value;
    let user_name = document.getElementById("User-name").value;
    let email = document.getElementById("Email").value;
    let phone = document.getElementById("Phonenumber").value;
    let Address = document.getElementById("Address").value;    

    let edited_details = {}
    edited_details["full_name"] = full_name;
    edited_details["user_name"] = user_name;
    edited_details["email"] = email;
    edited_details["phone"] = phone;
    edited_details["Address"] = Address;
    // console.log(edited_details);

    
    if(Email !== edited_details["email"]){
      console.log(Email)
      alert("You can't change the email")
    }else{
      let combine = Object.assign(user_profile,edited_details);

    let userindex = details.indexOf(user_profile)
    console.log(userindex)
    details[userindex] = combine;

    window.localStorage.setItem("User_data",JSON.stringify(details))

    // window.localStorage.setItem("updated_user_details",JSON.stringify(details))
    alert("Successfully updated your profile")
    } 
    });
});


deletes.addEventListener("click", function (event){
 event.preventDefault();

 let index = details.indexOf(user_profile);
 let failed = confirm("Cofirm to delete this");
 if(failed !== true){
 return;
 }else{
  details.splice(index, 1);
  localStorage.setItem("userdata", JSON.stringify(details));
  window.location.href = "./home-page.html"
 }

});



  </script>

</html>
